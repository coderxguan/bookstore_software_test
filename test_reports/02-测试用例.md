# 书海阁项目综合测试用例设计（JUnit实现版）

## 一、图书管理模块测试(甲)

### 1. 黑盒测试（等价类划分法和边界值分析法）

#### 1.1 等价类划分

##### 图书标题等价类
| 编号 | 类型 | 描述 |
| ---- | ---- | ---- |
| E1   | 有效 | 长度为1-50个字符的普通文本 |
| I1   | 无效 | 空字符串 |
| I2   | 无效 | 超过50个字符 |

##### 图书价格等价类
| 编号 | 类型 | 描述 |
| ---- | ---- | ---- |
| E3   | 有效 | 0.01-9999.99的数值 |
| I5   | 无效 | 零或负数 |
| I6   | 无效 | 超过10000的数值 |

#### 1.2 边界值分析

##### 图书价格边界值
```
  0      0.01                9999.99  10000
  │      │                       │       │
──┼──────┼───────────────────────┼───────┼──►
  │      │                       │       │
  │◄─────────有效范围E3─────────► │       │
  │      │                       │       │
  I5     │                       │      I6
```

#### 1.3 测试用例（关键示例）

| 测试用例ID | 测试用例名称 | 测试输入 | 预期结果 | 等价类覆盖 | JUnit实现备注 |
| ---- | -------- | --------- | -------- | ---- | ---- |
| TC-B01 | 添加有效图书 | 标题:"Java编程",<br>作者:"张三",<br>分类:"编程",<br>价格:88.50,<br>描述:"Java入门教程" | 添加成功，返回true，<br>且数据库中能查询到该记录 | E1, E3 | 使用断言验证返回值和数据库状态 |
| TC-B02 | 添加图书(标题为空) | 标题:"",<br>作者:"张三",<br>价格:88.50 | 添加失败，抛出异常或返回false，<br>提示"标题不能为空" | I1, E3 | 使用assertThrows或验证异常消息 |
| TC-B03 | 添加图书(价格无效) | 标题:"Java编程",<br>作者:"张三",<br>价格:-10 | 添加失败，抛出异常或返回false，<br>提示"价格必须大于0" | E1, I5 | 使用assertThrows或验证异常消息 |
| TC-B04 | 价格边界(最小) | 标题:"边界测试",<br>作者:"测试",<br>价格:0.01 | 添加成功，返回true | E3 | 断言方法返回true |
| TC-B05 | 价格边界(最大) | 标题:"边界测试",<br>作者:"测试",<br>价格:9999.99 | 添加成功，返回true | E3 | 断言方法返回true |
| TC-B06 | 价格边界(超出) | 标题:"边界测试",<br>作者:"测试",<br>价格:10000.00 | 添加失败，抛出异常或返回false | I6 | 使用assertThrows或验证错误消息 |

### 2. 白盒测试

#### 2.1 语句覆盖测试

| 测试用例ID | 测试用例名称 | 覆盖方法 | 测试数据 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- | -------- |
| TC-WB01 | 添加图书语句覆盖 | BookServiceImpl.addBook() | Book对象：<br>name:"Java编程"<br>author:"张三"<br>category:"编程"<br>price:88.50<br>description:"测试描述" | 返回true且数据库中存在该记录 | 使用@Test注解，调用service方法并断言结果 |
| TC-WB02 | 更新图书语句覆盖 | BookServiceImpl.updateBook() | 1. 先添加一本书获取ID<br>2. 修改参数:<br>name:"更新标题"<br>price:99.99 | 更新成功，返回true且数据已更新 | 需要先添加测试数据，再进行更新测试 |
| TC-WB03 | 删除图书语句覆盖 | BookServiceImpl.deleteBook() | 1. 先添加一本书获取ID=X<br>2. 调用deleteBook(X) | 删除成功，返回true且数据库中不存在该记录 | 先准备测试数据，再断言删除结果 |

#### 2.2 条件覆盖测试

| 测试用例ID | 测试用例名称 | 测试条件 | 条件值 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- | -------- |
| TC-CB01 | 图书价格条件判断(正值) | if (book.getPrice() <= 0) | book.price = 50.00 (false) | 价格校验通过，方法执行成功 | 设置正价格，验证方法执行成功 |
| TC-CB02 | 图书价格条件判断(零值) | if (book.getPrice() <= 0) | book.price = 0 (true) | 价格校验不通过，抛出异常或返回错误 | 设置0价格，验证方法抛出异常或返回错误 |
| TC-CB03 | 图书存在性判断 | if (bookExists) | 1. 存在: bookId=已存在ID<br>2. 不存在: bookId=999999 | 1. 存在: 操作成功<br>2. 不存在: 返回错误或抛出异常 | 需要先准备测试数据，测试两种分支情况 |

#### 2.3 路径测试

| 测试用例ID | 测试用例名称 | 测试路径 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- |
| TC-PB01 | 添加图书成功路径 | 1. 创建有效book对象<br>2. 调用addBook()<br>3. 验证返回值和数据库状态 | 添加成功，返回true且数据库中存在记录 | 完整路径测试，验证所有步骤结果 |
| TC-PB02 | 添加图书失败路径 | 1. 创建无效book对象(价格为负)<br>2. 调用addBook()<br>3. 捕获异常或错误返回 | 添加失败，抛出异常或返回false | 使用assertThrows或验证错误结果 |

## 二、图书搜索模块测试(乙)

### 1. 黑盒测试（决策表测试法）

#### 1.1 决策表分析（图书高级搜索条件组合）

| 条件/操作 | 规则1 | 规则2 | 规则3 | 规则4 |
|----------|-------|-------|-------|-------|
| **条件:** |       |       |       |       |
| 标题条件存在 | Y | Y | N | N |
| 作者条件存在 | Y | N | Y | N |
| **操作:** |       |       |       |       |
| 过滤标题 | ✓ | ✓ | - | - |
| 过滤作者 | ✓ | - | ✓ | - |
| 返回结果 | 满足全部条件的图书 | 满足标题的图书 | 满足作者的图书 | 返回全部图书 |

#### 1.2 测试用例（关键示例）

| 测试用例ID | 测试用例名称 | 测试输入 | 预期结果 | 对应规则 | JUnit实现备注 |
| ---- | -------- | --------- | -------- | ---- | ---- |
| TC-S01 | 标题+作者组合搜索 | 1. 插入测试数据<br>2. 调用搜索:<br>标题:"Java"<br>作者:"Bruce" | 返回同时满足条件的图书列表，<br>只包含标题含"Java"且作者含"Bruce"的图书 | 规则1 | 先准备测试数据，再验证搜索结果 |
| TC-S02 | 仅标题搜索 | 1. 插入测试数据<br>2. 调用搜索:<br>标题:"Java"<br>作者:"" | 返回标题匹配的图书列表，<br>包含所有标题含"Java"的图书 | 规则2 | 验证结果只按标题过滤 |
| TC-S03 | 仅作者搜索 | 1. 插入测试数据<br>2. 调用搜索:<br>标题:""<br>作者:"Bruce" | 返回作者匹配的图书列表，<br>包含所有作者含"Bruce"的图书 | 规则3 | 验证结果只按作者过滤 |
| TC-S04 | 无条件搜索 | 1. 插入测试数据<br>2. 调用搜索:<br>标题:""<br>作者:"" | 返回所有图书列表 | 规则4 | 验证返回完整列表 |
| TC-S05 | 按收藏量排序 | 1. 准备多本图书，收藏量不同<br>2. 调用排序:<br>排序类型:"desc" | 返回按收藏量从高到低排序的图书列表 | - | 验证列表顺序符合收藏量降序 |

### 2. 白盒测试

#### 2.1 语句覆盖测试

| 测试用例ID | 测试用例名称 | 覆盖方法 | 测试数据 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- | -------- |
| TC-WS01 | 简单搜索语句覆盖 | BookServiceImpl.listAllBooks() | 1. 准备测试数据<br>2. 关键词:"Java" | 返回包含"Java"的图书列表 | 验证返回结果包含预期的图书项 |
| TC-WS03 | 排序功能语句覆盖 | BookServiceImpl.listAllBooksAndSortByFavoriteCount() | 1. 准备收藏量不同的图书<br>2. 排序类型:"desc" | 返回按收藏量降序排列的结果 | 验证排序顺序正确 |

#### 2.2 条件覆盖测试

| 测试用例ID | 测试用例名称 | 测试条件 | 条件值 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- | -------- |
| TC-CS01 | 搜索条件非空判断(标题) | if (StringUtils.isNotEmpty(title)) | 1. true: title="Java"<br>2. false: title="" | 1. 应用标题过滤<br>2. 不应用标题过滤 | 分别测试两个分支，验证结果 |
| TC-CS02 | 搜索条件非空判断(作者) | if (StringUtils.isNotEmpty(author)) | 1. true: author="Bruce"<br>2. false: author="" | 1. 应用作者过滤<br>2. 不应用作者过滤 | 分别测试两个分支，验证结果 |

## 三、收藏管理模块测试(丙)

### 1. 黑盒测试（状态转换测试法）

#### 1.1 收藏功能状态图

```
                 ┌───────────────┐
                 │               │
                 │   未收藏状态    │
                 │               │
                 └───────┬───────┘
                         │
                         │ 添加收藏
                         ▼
                 ┌───────────────┐
                 │               │
                 │   已收藏状态    │
                 │               │
                 └───────┬───────┘
                         │
                         │ 取消收藏
                         ▼
                 ┌───────────────┐
                 │               │
                 │   未收藏状态    │
                 │               │
                 └───────────────┘
```

#### 1.2 测试用例（关键示例）

##### 测试场景1: 状态转换测试
| 测试用例ID | 测试用例名称 | 测试步骤 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | ---- |
| TC-F01 | 未收藏→已收藏 | 1. 准备用户ID=1和图书ID=1<br>2. 确认isFavorite(1,1)返回false<br>3. 调用addFavorite(1,1) | 1. addFavorite返回true<br>2. isFavorite(1,1)返回true<br>3. 图书收藏计数+1 | 需要Mock BookService或准备真实数据 |
| TC-F02 | 已收藏→未收藏 | 1. 准备用户ID=1和图书ID=1<br>2. 确保已收藏状态<br>3. 调用removeFavorite(1,1) | 1. removeFavorite返回true<br>2. isFavorite(1,1)返回false<br>3. 图书收藏计数-1 | 需要先添加收藏，再测试取消功能 |
| TC-F03 | 已收藏状态下再次收藏(无效转换) | 1. 准备用户ID=1和图书ID=1<br>2. 确保已收藏状态<br>3. 调用addFavorite(1,1) | 1. addFavorite返回false<br>2. 收藏状态和计数不变 | 验证重复收藏的错误处理 |

##### 测试场景2: 收藏计数功能
| 测试用例ID | 测试用例名称 | 测试步骤 | 预期结果 | JUnit实现备注 |
| ---- | -------- | --------- | -------- | ---- |
| TC-F04 | 添加收藏后计数增加 | 1. 准备用户ID=1和图书ID=1<br>2. 记录原收藏计数count<br>3. 调用addFavorite(1,1) | 1. 添加收藏成功<br>2. 图书收藏计数变为count+1 | 需要验证数据库中计数正确更新 |
| TC-F05 | 取消收藏后计数减少 | 1. 准备已收藏状态的记录<br>2. 记录原收藏计数count<br>3. 调用removeFavorite(1,1) | 1. 取消收藏成功<br>2. 图书收藏计数变为count-1 | 需要验证数据库中计数正确更新 |
| TC-F06 | 多用户收藏同一图书 | 1. 准备两个用户id=1,2<br>2. 同一图书id=1<br>3. 执行addFavorite(1,1)<br>4. 执行addFavorite(2,1) | 每个成功收藏操作使计数+1，<br>最终计数增加2 | 模拟多用户场景，验证计数累加 |

### 2. 白盒测试

#### 2.1 语句覆盖测试

| 测试用例ID | 测试用例名称 | 覆盖方法 | 测试数据 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- | -------- |
| TC-WF01 | 添加收藏语句覆盖 | FavoriteServiceImpl.addFavorite() | 1. 用户ID=1<br>2. 图书ID=1<br>3. 未收藏状态 | 1. 返回true<br>2. 收藏记录添加成功<br>3. 图书收藏计数+1 | 需要Mock BookService.incrementFavoriteCount方法 |
| TC-WF02 | 取消收藏语句覆盖 | FavoriteServiceImpl.removeFavorite() | 1. 用户ID=1<br>2. 图书ID=1<br>3. 已收藏状态 | 1. 返回true<br>2. 收藏记录删除成功<br>3. 图书收藏计数-1 | 需要Mock BookService.decrementFavoriteCount方法 |
| TC-WF04 | 获取收藏列表语句覆盖 | FavoriteServiceImpl.getAllUserFavorites() | 1. 用户ID=1<br>2. 已添加多条收藏记录 | 返回所有收藏的图书列表 | 需要准备多条收藏记录并验证结果 |

#### 2.2 条件覆盖测试

| 测试用例ID | 测试用例名称 | 测试条件 | 条件值和步骤 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- | -------- |
| TC-CF01 | 收藏状态判断(已收藏) | if (favoriteExists) | 1. 准备已收藏状态<br>2. 调用addFavorite(1,1) | 操作失败，返回false | 验证已收藏状态下不能重复收藏 |
| TC-CF02 | 收藏状态判断(未收藏) | if (favoriteExists) | 1. 准备未收藏状态<br>2. 调用addFavorite(1,1) | 操作成功，返回true | 验证未收藏状态可以添加收藏 |
| TC-CF03 | 图书存在判断 | if (bookExists) | 1. 有效bookId=1<br>2. 无效bookId=99999 | 1. 有效ID: 操作成功<br>2. 无效ID: 抛出异常或返回false | 需要Mock或准备数据库环境 |

#### 2.3 路径测试

| 测试用例ID | 测试用例名称 | 测试路径 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- |
| TC-PF01 | 添加收藏成功路径 | 1. 准备有效userId=1, bookId=1<br>2. 确认图书存在且未收藏<br>3. 调用addFavorite(1,1)<br>4. 验证数据库记录和收藏计数 | 添加收藏成功，<br>记录添加且计数+1 | 测试完整添加收藏路径 |
| TC-PF02 | 取消收藏成功路径 | 1. 准备已收藏状态<br>2. 调用removeFavorite(1,1)<br>3. 验证数据库记录和收藏计数 | 取消收藏成功，<br>记录删除且计数-1 | 测试完整取消收藏路径 |

## 四、用户界面与登录注册模块测试(丁)

### 1. 黑盒测试（边界值分析法）

#### 1.1 用户名和密码边界值

##### 用户名长度边界值
```
  0      5                       20      21
  │      │                       │       │
──┼──────┼───────────────────────┼───────┼──►
  │      │                       │       │
  │ ◄─────────有效范围─────────►  │       │
```

#### 1.2 测试用例（关键示例）

| 测试用例ID | 测试用例名称 | 测试输入 | 预期结果 | JUnit实现备注 |
| ---- | -------- | --------- | -------- | ---- |
| TC-U01 | 用户名长度边界(最小) | 用户名:"user1"(5字符)<br>密码:"password" | 注册成功，返回用户对象或成功标识 | 测试最小长度用户名是否被接受 |
| TC-U02 | 用户名长度边界(最大) | 用户名:"user12345678901234567"(20字符)<br>密码:"password" | 注册成功，返回用户对象或成功标识 | 测试最大长度用户名是否被接受 |
| TC-U03 | 用户名长度边界(不足) | 用户名:"usr"(3字符)<br>密码:"password" | 注册失败，抛出异常或返回错误消息 | 测试过短用户名是否被拒绝 |
| TC-U04 | 用户名长度边界(超出) | 用户名:"u123456789012345678901"(21字符)<br>密码:"password" | 注册失败，抛出异常或返回错误消息 | 测试过长用户名是否被拒绝 |
| TC-U05 | 登录状态测试 | 1. 用户登录: <br>用户名:"testuser"<br>密码:"password"<br>2. 获取登录token或session<br>3. 请求需授权的接口 | 成功访问需要登录的功能，<br>返回200状态码和预期数据 | 需要集成测试或模拟HTTP请求 |

### 2. 白盒测试

#### 2.1 语句覆盖测试

| 测试用例ID | 测试用例名称 | 覆盖方法 | 测试数据 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- | -------- |
| TC-WU01 | 用户注册语句覆盖 | UserServiceImpl.register() | 用户名:"testuser"<br>密码:"password"<br>邮箱:"test@example.com" | 注册成功，返回新用户对象<br>且数据库中有记录 | 验证方法成功执行并返回预期结果 |
| TC-WU02 | 用户登录语句覆盖 | UserServiceImpl.login() | 用户名:"testuser"<br>密码:"password" | 登录成功，返回用户对象或token | 需要先注册用户再测试登录 |
| TC-WU03 | 登出功能语句覆盖 | UserServiceImpl.logout() | 有效的sessionId或token | 登出成功，返回true<br>且session失效 | 需要先登录获取session再测试登出 |

#### 2.2 条件覆盖测试

| 测试用例ID | 测试用例名称 | 测试条件 | 条件值和步骤 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- | -------- |
| TC-CU01 | 用户名存在判断 | if (userExists) | 1. 已存在: 注册用户"existing"<br>2. 不存在: 使用名称"nonexisting" | 1. 已存在: 注册失败<br>2. 不存在: 注册成功 | 测试用户名唯一性校验 |
| TC-CU02 | 密码匹配判断 | if (passwordMatches) | 1. 正确密码: "correctpwd"<br>2. 错误密码: "wrongpwd" | 1. 正确: 登录成功<br>2. 错误: 登录失败 | 需要先创建用户再测试不同密码 |
| TC-CU03 | 用户状态判断 | if (user.getStatus() != 1) | 1. 状态正常(status=1)<br>2. 状态禁用(status=0) | 1. 正常: 登录成功<br>2. 禁用: 登录失败 | 需要准备不同状态的用户数据 |

#### 2.3 路径测试

| 测试用例ID | 测试用例名称 | 测试路径 | 预期结果 | JUnit实现备注 |
| ---- | -------- | -------- | -------- | -------- |
| TC-PU01 | 登录成功路径 | 1. 准备有效用户<br>2. 使用正确用户名密码<br>3. 调用login方法<br>4. 验证返回用户对象 | 登录成功，<br>返回有效用户对象或token | 测试完整登录路径 |
| TC-PU02 | 登录失败路径(用户不存在) | 1. 使用不存在的用户名<br>2. 调用login方法<br>3. 捕获异常或错误返回 | 登录失败，<br>返回错误消息或null | 测试用户不存在分支 |
| TC-PU03 | 登录失败路径(密码错误) | 1. 准备有效用户<br>2. 使用错误密码<br>3. 调用login方法<br>4. 捕获异常或错误返回 | 登录失败，<br>返回错误消息或null | 测试密码错误分支 | 