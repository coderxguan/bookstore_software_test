# 书海阁项目测试缺陷报告

## 测试执行摘要

- **测试日期**: 2025年5月20日
- **测试环境**: Java 17, Spring Boot 3.2.3, MySQL
- **测试版本**: v1.0
- **测试工具**: JUnit 5, Maven Surefire
- **总测试用例数**: 118
- **通过数**: 85
- **失败数**: 20
- **错误数**: 13
- **跳过数**: 0

## 缺陷汇总表（全部）

| 编号     | 所属模块   | 用例名/方法                                 | 缺陷描述                           | 严重级别 | 状态   |
|----------|------------|---------------------------------------------|------------------------------------|----------|--------|
| DEF-001  | 图书管理   | testAddBook_titleEmpty                      | 期望抛出异常但未抛出               | 高       | 待修复 |
| DEF-002  | 图书管理   | testAddBook_titleTooLong                     | 期望抛出异常但未抛出               | 高       | 待修复 |
| DEF-003  | 图书管理   | testAddBook_authorTooLong                    | 期望抛出异常但未抛出               | 高       | 待修复 |
| DEF-004  | 图书管理   | testAddBook_categoryEmpty                    | 期望抛出异常但未抛出               | 高       | 待修复 |
| DEF-005  | 图书管理   | testAddBook_priceZero                        | 期望抛出异常但未抛出               | 高       | 待修复 |
| DEF-006  | 图书管理   | testAddBook_priceTooHigh                     | 期望抛出异常但未抛出               | 高       | 待修复 |
| DEF-007  | 图书管理   | testAddBook_descriptionTooLong               | 期望抛出异常但未抛出               | 高       | 待修复 |
| DEF-008  | 图书管理   | testListAllBooks_singleBookMatch             | 匹配数量不符                       | 中       | 待修复 |
| DEF-009  | 图书管理   | testListAllBooks_partialMatch                | 匹配数量不符                       | 中       | 待修复 |
| DEF-010  | 图书管理   | testListAllBooks_allMatch                    | 匹配数量不符                       | 中       | 待修复 |
| DEF-011  | 图书管理   | testListAllBooks_largeData                   | 匹配数量不符                       | 中       | 待修复 |
| DEF-012  | 图书管理   | testGetBookDetail_authorNull                 | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-013  | 图书管理   | testGetBookDetail_bookNotNull                | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-014  | 图书管理   | testGetBookDetail_authorNullOrEmpty          | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-015  | 图书管理   | testGetBookDetail_authorNormalizePath        | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-016  | 图书管理   | testGetBookDetail_authorIsNull               | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-017  | 图书管理   | testListAllBooks_nullFields                  | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-018  | 收藏管理   | testAddFavorite_TC_F02_invalidUserId         | 期望false但返回true                | 高       | 待修复 |
| DEF-019  | 收藏管理   | testAddFavorite_TC_F03_invalidBookId         | 期望false但返回true                | 高       | 待修复 |
| DEF-020  | 用户注册   | testRegister_TC_U02_usernameTooShort         | 期望false但返回true                | 高       | 待修复 |
| DEF-021  | 用户注册   | testRegister_TC_U03_usernameTooLong          | 期望false但返回true                | 高       | 待修复 |
| DEF-022  | 用户注册   | testRegister_TC_U05_passwordTooShort         | 期望false但返回true                | 高       | 待修复 |
| DEF-023  | 用户注册   | testRegister_TC_U06_passwordTooLong          | 期望false但返回true                | 高       | 待修复 |
| DEF-024  | 图书管理   | testGetBookDetail_bookNull                   | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-025  | 收藏管理   | testAddFavorite_TCF_SC01_invalidUserId       | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-026  | 收藏管理   | testAddFavorite_TCF_SC02_invalidBookId       | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-027  | 收藏管理   | testAddFavorite_TCF_CC01_userIdNull          | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-028  | 收藏管理   | testAddFavorite_TCF_CC03_bookIdNull          | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-029  | 收藏管理   | testAddFavorite_TCF_DC01_userOrBookIdNull    | 数据库字段不允许null导致异常        | 高       | 待修复 |
| DEF-030  | 收藏管理   | testAddFavorite_TCF_PC01_paramInvalidPath     | 数据库字段不允许null导致异常        | 高       | 待修复 |

## 详细缺陷报告

### DEF-001
- 所属模块：图书管理
- 用例名/方法：testAddBook_titleEmpty
- 复现步骤：调用添加图书接口，标题为空
- 实际结果：未抛出异常，添加成功
- 期望结果：抛出异常，提示标题不能为空
- 严重级别：高
- 建议：完善输入校验，抛出异常

### DEF-002
- 所属模块：图书管理
- 用例名/方法：testAddBook_titleTooLong
- 复现步骤：调用添加图书接口，标题超长（>50字符）
- 实际结果：未抛出异常，添加成功
- 期望结果：抛出异常，提示标题过长
- 严重级别：高
- 建议：完善输入校验，抛出异常

### DEF-003
- 所属模块：图书管理
- 用例名/方法：testAddBook_authorTooLong
- 复现步骤：调用添加图书接口，作者超长（>30字符）
- 实际结果：未抛出异常，添加成功
- 期望结果：抛出异常，提示作者过长
- 严重级别：高
- 建议：完善输入校验，抛出异常

### DEF-004
- 所属模块：图书管理
- 用例名/方法：testAddBook_categoryEmpty
- 复现步骤：调用添加图书接口，分类为空
- 实际结果：未抛出异常，添加成功
- 期望结果：抛出异常，提示分类不能为空
- 严重级别：高
- 建议：完善输入校验，抛出异常

### DEF-005
- 所属模块：图书管理
- 用例名/方法：testAddBook_priceZero
- 复现步骤：调用添加图书接口，价格为0
- 实际结果：未抛出异常，添加成功
- 期望结果：抛出异常，提示价格无效
- 严重级别：高
- 建议：完善输入校验，抛出异常

### DEF-006
- 所属模块：图书管理
- 用例名/方法：testAddBook_priceTooHigh
- 复现步骤：调用添加图书接口，价格超上限（>9999.99）
- 实际结果：未抛出异常，添加成功
- 期望结果：抛出异常，提示价格无效
- 严重级别：高
- 建议：完善输入校验，抛出异常

### DEF-007
- 所属模块：图书管理
- 用例名/方法：testAddBook_descriptionTooLong
- 复现步骤：调用添加图书接口，描述超长（>200字符）
- 实际结果：未抛出异常，添加成功
- 期望结果：抛出异常，提示描述过长
- 严重级别：高
- 建议：完善输入校验，抛出异常

### DEF-008
- 所属模块：图书管理
- 用例名/方法：testListAllBooks_singleBookMatch
- 复现步骤：查询包含1本图书的列表，使用匹配的查询词
- 实际结果：返回的匹配数量不符
- 期望结果：返回包含该图书的列表
- 严重级别：中
- 建议：检查查询逻辑，确保匹配准确

### DEF-009
- 所属模块：图书管理
- 用例名/方法：testListAllBooks_partialMatch
- 复现步骤：查询多本图书，使用部分匹配的查询词
- 实际结果：返回的匹配数量不符
- 期望结果：返回匹配的图书列表
- 严重级别：中
- 建议：检查查询逻辑，确保匹配准确

### DEF-010
- 所属模块：图书管理
- 用例名/方法：testListAllBooks_allMatch
- 复现步骤：查询多本图书，使用能匹配所有图书的查询词
- 实际结果：返回的匹配数量不符
- 期望结果：返回所有图书的列表
- 严重级别：中
- 建议：检查查询逻辑，确保匹配准确

### DEF-011
- 所属模块：图书管理
- 用例名/方法：testListAllBooks_largeData
- 复现步骤：查询大数据量图书，使用匹配的查询词
- 实际结果：返回的匹配数量不符
- 期望结果：返回所有匹配的图书列表
- 严重级别：中
- 建议：检查查询逻辑和性能

### DEF-012
- 所属模块：图书管理
- 用例名/方法：testGetBookDetail_authorNull
- 复现步骤：添加作者为null的图书，调用详情接口
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：保存前补全默认值或调整表结构允许null

### DEF-013
- 所属模块：图书管理
- 用例名/方法：testGetBookDetail_bookNotNull
- 复现步骤：添加book为null的情况，调用详情接口
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：保存前补全默认值或调整表结构允许null

### DEF-014
- 所属模块：图书管理
- 用例名/方法：testGetBookDetail_authorNullOrEmpty
- 复现步骤：添加作者为null或空字符串的图书，调用详情接口
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：保存前补全默认值或调整表结构允许null

### DEF-015
- 所属模块：图书管理
- 用例名/方法：testGetBookDetail_authorNormalizePath
- 复现步骤：添加作者为null的图书，调用详情接口
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：保存前补全默认值或调整表结构允许null

### DEF-016
- 所属模块：图书管理
- 用例名/方法：testGetBookDetail_authorIsNull
- 复现步骤：添加作者为null的图书，调用详情接口
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：保存前补全默认值或调整表结构允许null

### DEF-017
- 所属模块：图书管理
- 用例名/方法：testListAllBooks_nullFields
- 复现步骤：图书部分字段为null，调用列表接口
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：保存前补全默认值或调整表结构允许null

### DEF-018
- 所属模块：收藏管理
- 用例名/方法：testAddFavorite_TC_F02_invalidUserId
- 复现步骤：调用添加收藏，userId为-1
- 实际结果：返回true
- 期望结果：返回false
- 严重级别：高
- 建议：完善参数校验

### DEF-019
- 所属模块：收藏管理
- 用例名/方法：testAddFavorite_TC_F03_invalidBookId
- 复现步骤：调用添加收藏，bookId为-1
- 实际结果：返回true
- 期望结果：返回false
- 严重级别：高
- 建议：完善参数校验

### DEF-020
- 所属模块：用户注册
- 用例名/方法：testRegister_TC_U02_usernameTooShort
- 复现步骤：注册时输入用户名为"usr"（少于5字符），密码为"passwd123"
- 实际结果：注册接口返回true，注册成功
- 期望结果：注册接口返回false，提示用户名过短
- 严重级别：高
- 建议：完善注册参数校验，用户名长度不足时应注册失败并给出明确提示

### DEF-021
- 所属模块：用户注册
- 用例名/方法：testRegister_TC_U03_usernameTooLong
- 复现步骤：注册时输入用户名为21字符，密码为"passwd123"
- 实际结果：注册接口返回true，注册成功
- 期望结果：注册接口返回false，提示用户名过长
- 严重级别：高
- 建议：完善注册参数校验，用户名过长时应注册失败并给出明确提示

### DEF-022
- 所属模块：用户注册
- 用例名/方法：testRegister_TC_U05_passwordTooShort
- 复现步骤：注册时输入密码为"123"（少于6字符）
- 实际结果：注册接口返回true，注册成功
- 期望结果：注册接口返回false，提示密码过短
- 严重级别：高
- 建议：完善注册参数校验，密码过短时应注册失败并给出明确提示

### DEF-023
- 所属模块：用户注册
- 用例名/方法：testRegister_TC_U06_passwordTooLong
- 复现步骤：注册时输入密码为21字符
- 实际结果：注册接口返回true，注册成功
- 期望结果：注册接口返回false，提示密码过长
- 严重级别：高
- 建议：完善注册参数校验，密码过长时应注册失败并给出明确提示

### DEF-024
- 所属模块：图书管理
- 用例名/方法：testGetBookDetail_bookNull
- 复现步骤：添加book为null的情况，调用详情接口
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：保存前补全默认值或调整表结构允许null

### DEF-025
- 所属模块：收藏管理
- 用例名/方法：testAddFavorite_TCF_SC01_invalidUserId
- 复现步骤：调用添加收藏，userId为null
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：参数校验和数据库约束需一致

### DEF-026
- 所属模块：收藏管理
- 用例名/方法：testAddFavorite_TCF_SC02_invalidBookId
- 复现步骤：调用添加收藏，bookId为null
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：参数校验和数据库约束需一致

### DEF-027
- 所属模块：收藏管理
- 用例名/方法：testAddFavorite_TCF_CC01_userIdNull
- 复现步骤：调用添加收藏，userId为null
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：参数校验和数据库约束需一致

### DEF-028
- 所属模块：收藏管理
- 用例名/方法：testAddFavorite_TCF_CC03_bookIdNull
- 复现步骤：调用添加收藏，bookId为null
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：参数校验和数据库约束需一致

### DEF-029
- 所属模块：收藏管理
- 用例名/方法：testAddFavorite_TCF_DC01_userOrBookIdNull
- 复现步骤：调用添加收藏，userId或bookId为null
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：参数校验和数据库约束需一致

### DEF-030
- 所属模块：收藏管理
- 用例名/方法：testAddFavorite_TCF_PC01_paramInvalidPath
- 复现步骤：调用添加收藏，userId或bookId为null
- 实际结果：数据库报错，字段不允许null
- 期望结果：业务层处理null，数据库不报错
- 严重级别：高
- 建议：参数校验和数据库约束需一致

## 总结与建议

- 本轮测试发现大量输入校验、边界处理、数据库约束等问题，建议：
  1. 业务层严格校验所有输入参数，防止无效数据入库。
  2. 重要字段如name、author等建议在数据库层允许null或在保存前补全默认值。
  3. 测试用例与实际实现需保持一致，及时修正断言和异常处理。
  4. 建议开发与测试团队协作，逐条修复上述缺陷后回归测试。

本报告基于2025年5月20日最新测试结果自动生成。 