# 书海阁项目缺陷报告

## 1. 缺陷报告概述

- **项目名称**: 书海阁图书管理系统
- **测试周期**: 2025-05-01 至 2025-05-10
- **报告生成日期**: 2025-05-14
- **测试团队**: 软件测试小组

### 1.1 缺陷统计

| 缺陷优先级 | 缺陷数量 | 已修复 | 未修复 | 修复率 |
|----------|---------|-------|-------|-------|
| 严重 | 1 | 0 | 1 | 0% |
| 高 | 1 | 0 | 1 | 0% |
| 中 | 2 | 0 | 2 | 0% |
| 低 | 1 | 0 | 1 | 0% |
| **总计** | **5** | **0** | **5** | **0%** |

### 1.2 缺陷分布

| 功能模块 | 缺陷数量 | 占比 |
|---------|---------|-----|
| 图书管理模块 | 2 | 40% |
| 图书搜索模块 | 1 | 20% |
| 收藏管理模块 | 2 | 40% |
| 用户界面与登录注册模块 | 0 | 0% |
| **总计** | **5** | **100%** |

## 2. 缺陷详细报告

### 2.1 [严重] 图书搜索功能特殊字符处理问题

- **缺陷ID**: BUG-001
- **所属模块**: 图书搜索模块
- **相关测试用例**: TS-2.3 (包含特殊字符搜索)
- **缺陷描述**: 在搜索包含特殊字符(&、#、<、>等)的图书标题时系统抛出SQL异常
- **复现步骤**:
  1. 进入图书搜索页面
  2. 在标题搜索框中输入含有特殊字符的搜索词，如"C#&.NET"
  3. 点击搜索按钮
- **实际结果**: 系统返回500错误，后台日志显示SQL语法错误
- **预期结果**: 系统应正确处理特殊字符，返回相关图书或空结果
- **影响范围**: 所有包含特殊字符的搜索操作
- **优先级**: 严重
- **状态**: 未修复
- **建议解决方案**:
  1. 在SearchController中添加参数过滤与转义逻辑
  2. 使用预编译SQL语句替代字符串拼接
  3. 在前端添加特殊字符验证

### 2.2 [高] 图书删除后列表刷新问题

- **缺陷ID**: BUG-002
- **所属模块**: 图书管理模块
- **相关测试用例**: TM-5.1 (正常删除图书)
- **缺陷描述**: 删除图书操作成功后，前端页面未正确刷新，用户仍能看到已删除的图书
- **复现步骤**:
  1. 登录管理员账号
  2. 进入图书列表页面
  3. 选择一本图书点击删除按钮
  4. 在确认对话框中点击确认
- **实际结果**: 图书成功从数据库删除，但前端列表不刷新，仍显示已删除的图书
- **预期结果**: 图书删除后，前端列表应立即刷新，不再显示已删除的图书
- **影响范围**: 图书管理功能
- **优先级**: 高
- **状态**: 未修复
- **建议解决方案**:
  1. 在删除成功回调中添加列表刷新逻辑
  2. 优化前端状态管理，保证UI与数据同步

### 2.3 [中] 负价格图书显示问题

- **缺陷ID**: BUG-003
- **所属模块**: 图书管理模块
- **相关测试用例**: TM-2.3 (特殊字段处理测试)
- **缺陷描述**: 当图书价格为负值时，系统直接显示负价格，而不是将其转换为0.00
- **复现步骤**:
  1. 访问ID为3的图书详情页，该图书价格在数据库中为负数
  2. 观察价格显示
- **实际结果**: 前端页面显示了负价格，如"-10.00元"
- **预期结果**: 前端应当显示"0.00元"
- **影响范围**: 图书详情展示
- **优先级**: 中
- **状态**: 未修复
- **建议解决方案**:
  1. 在BookServiceImpl的getBookDetail方法中增加价格有效性检查
  2. 增加前端价格显示的数据处理逻辑

### 2.4 [中] 已删除图书在收藏列表处理问题

- **缺陷ID**: BUG-004
- **所属模块**: 收藏管理模块
- **相关测试用例**: TF-3.3 (查看已删除图书的处理)
- **缺陷描述**: 当用户收藏的图书被管理员删除后，用户访问收藏列表并点击该图书会导致错误
- **复现步骤**:
  1. 用户收藏ID为8的图书
  2. 管理员删除ID为8的图书
  3. 用户访问收藏列表
  4. 点击已删除的图书
- **实际结果**: 系统跳转到错误页面，显示500服务器错误
- **预期结果**: 系统应提示"该图书已不可用"或类似信息，不应导致错误
- **影响范围**: 收藏管理功能
- **优先级**: 中
- **状态**: 未修复
- **建议解决方案**:
  1. 在FavoriteServiceImpl中检查收藏图书是否仍存在
  2. 收藏列表页面对已删除图书增加状态标识
  3. 前端处理图书不存在的情况，显示友好提示

### 2.5 [低] 收藏按钮状态切换延迟

- **缺陷ID**: BUG-005
- **所属模块**: 收藏管理模块
- **相关测试用例**: TF-1.1 (正常收藏图书)
- **缺陷描述**: 点击收藏按钮后，按钮状态变化有明显延迟，可能导致用户多次点击
- **复现步骤**:
  1. 登录用户账号
  2. 进入任意图书详情页
  3. 点击"收藏"按钮
  4. 观察按钮状态变化
- **实际结果**: 收藏操作成功，但按钮状态变化有约500ms的延迟
- **预期结果**: 点击后按钮应立即变为"已收藏"状态
- **影响范围**: 收藏功能用户体验
- **优先级**: 低
- **状态**: 未修复
- **建议解决方案**:
  1. 优化前端状态管理，使用乐观更新模式
  2. 在等待后端响应期间禁用按钮，防止重复点击

## 3. 缺陷趋势分析

本次测试发现的缺陷主要集中在数据处理和UI交互方面。其中严重级别的缺陷主要出现在数据安全处理方面，中低级别的缺陷主要与用户体验相关。

## 4. 改进建议

### 4.1 开发流程改进

1. **代码审查**: 加强针对特殊字符处理和数据验证的代码审查
2. **单元测试**: 增加边界条件和异常情况的单元测试覆盖
3. **UI/UX设计**: 改进用户界面交互设计，特别是状态反馈机制

### 4.2 测试流程改进

1. **测试数据**: 构建更多包含特殊情况的测试数据
2. **自动化测试**: 增加前端UI自动化测试，覆盖关键用户操作
3. **性能测试**: 针对前端响应延迟问题增加性能测试

## 5. 结论

书海阁项目当前存在5个未修复的缺陷，涵盖不同优先级和功能模块。其中最严重的问题是特殊字符处理导致的安全隐患，应优先修复。总体来看，这些缺陷不会完全阻碍系统的主要功能，但会影响用户体验和系统稳定性。建议根据优先级顺序逐步解决这些问题，并加强相关领域的测试覆盖。

## 6. 附录

### 6.1 测试环境信息

- **操作系统**: Windows 10/macOS Monterey
- **浏览器**: Chrome 116.0.5845.187, Firefox 117.0.1
- **后端**: Java 17, Spring Boot 3.1.3
- **数据库**: MySQL 8.0.26
- **测试工具**: JUnit 5, Postman, Chrome DevTools

### 6.2 相关文档链接

- [测试计划](/test_reports/01-测试计划.md)
- [测试用例](/test_reports/02-测试用例.md)
- [测试用例报告](/test_reports/03-测试用例报告.md)
- [测试总结报告](/test_reports/05-测试总结报告.md)